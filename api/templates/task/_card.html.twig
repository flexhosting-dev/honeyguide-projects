{# Task Card Component for Kanban #}
<div data-task-id="{{ task.id }}"
     {% if draggable|default(false) %}
     draggable="true"
     ondragstart="kanbanDragStart(event, '{{ task.id }}')"
     ondragend="kanbanDragEnd(event)"
     {% endif %}
     class="task-card bg-white rounded-lg shadow-sm border border-gray-200 p-4 {{ draggable|default(false) ? 'cursor-move' : '' }} hover:shadow-md transition-all duration-200">
    <div class="flex items-start justify-between">
        <h4 class="text-sm font-medium text-gray-900 flex-1">
            <a href="{{ path('app_task_show', {id: task.id}) }}"
               class="hover:text-primary-600 task-link"
               data-task-id="{{ task.id }}"
               onclick="event.preventDefault(); openTaskPanel('{{ task.id }}');">
                {{ task.title }}
            </a>
        </h4>
        <span class="ml-2 flex-shrink-0 inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium
            {% if task.priority.value == 'high' %}bg-red-100 text-red-700
            {% elseif task.priority.value == 'medium' %}bg-yellow-100 text-yellow-700
            {% elseif task.priority.value == 'low' %}bg-blue-100 text-blue-700
            {% else %}bg-gray-100 text-gray-700{% endif %}">
            {{ task.priority.label }}
        </span>
    </div>

    <p class="mt-1 text-xs text-gray-500">{{ task.project.name }}</p>

    <div class="mt-3 flex items-center justify-between">
        <div class="flex items-center space-x-3">
            {% if task.dueDate %}
                <span class="flex items-center text-xs {{ task.isOverdue ? 'text-red-600 font-medium' : 'text-gray-500' }}">
                    <svg class="mr-1 h-4 w-4" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5" />
                    </svg>
                    {{ task.dueDate|date('M d') }}
                </span>
            {% endif %}

            {% if task.commentCount > 0 %}
                <span class="flex items-center text-xs text-gray-500">
                    <svg class="mr-1 h-4 w-4" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 20.25c4.97 0 9-3.694 9-8.25s-4.03-8.25-9-8.25S3 7.444 3 12c0 2.104.859 4.023 2.273 5.48.432.447.74 1.04.586 1.641a4.483 4.483 0 0 1-.923 1.785A5.969 5.969 0 0 0 6 21c1.282 0 2.47-.402 3.445-1.087.81.22 1.668.337 2.555.337Z" />
                    </svg>
                    {{ task.commentCount }}
                </span>
            {% endif %}
        </div>

        {% if task.assignees|length > 0 %}
            <div class="flex -space-x-1">
                {% for assignee in task.assignees|slice(0, 3) %}
                    <span class="inline-flex h-6 w-6 items-center justify-center rounded-full bg-primary-100 ring-2 ring-white">
                        <span class="text-xs font-medium text-primary-700">
                            {{ assignee.user.firstName|slice(0, 1)|upper }}
                        </span>
                    </span>
                {% endfor %}
                {% if task.assignees|length > 3 %}
                    <span class="inline-flex h-6 w-6 items-center justify-center rounded-full bg-gray-100 ring-2 ring-white text-xs font-medium text-gray-500">
                        +{{ task.assignees|length - 3 }}
                    </span>
                {% endif %}
            </div>
        {% endif %}
    </div>
</div>
