{# Sidebar Component #}
{% set theme = app.user.uiTheme|default('gradient') %}

<div class="hidden lg:fixed lg:inset-y-0 lg:z-50 lg:flex lg:w-72 lg:flex-col">
    {% if theme == 'gradient' %}
    {# Gradient Theme #}
    <div class="flex grow flex-col gap-y-5 overflow-y-auto sidebar-scroll bg-gradient-to-b from-primary-600 via-primary-700 to-indigo-800 px-6 pb-4 relative">
        {# Decorative background elements #}
        <div class="absolute inset-0 overflow-hidden pointer-events-none" aria-hidden="true">
            <div class="absolute -top-20 -right-20 w-64 h-64 bg-white/5 rounded-full blur-3xl"></div>
            <div class="absolute top-1/3 -left-10 w-40 h-40 bg-indigo-400/10 rounded-full blur-2xl"></div>
            <div class="absolute bottom-1/4 right-0 w-32 h-32 bg-primary-300/10 rounded-full blur-xl"></div>
            <div class="absolute -bottom-10 left-1/4 w-48 h-48 bg-white/5 rounded-full blur-3xl"></div>
        </div>

        <div class="relative flex h-16 shrink-0 items-center">
            <span class="text-2xl">ðŸ“‹</span>
            <span class="ml-2 text-xl font-bold text-white drop-shadow-sm">WorkFlow</span>
        </div>
        <nav class="relative flex flex-1 flex-col">
            <ul role="list" class="flex flex-1 flex-col gap-y-7">
                <li>
                    <ul role="list" class="-mx-2 space-y-1">
                        <li>
                            <a href="{{ path('app_dashboard') }}"
                               class="{{ app.request.get('_route') == 'app_dashboard' ? 'bg-white/20 text-white' : 'text-white/80 hover:bg-white/10 hover:text-white' }} group flex gap-x-3 rounded-lg p-2.5 text-sm font-semibold leading-6 transition-all">
                                <svg class="h-6 w-6 shrink-0 {{ app.request.get('_route') == 'app_dashboard' ? 'text-white' : 'text-white/70 group-hover:text-white' }}" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25" />
                                </svg>
                                Dashboard
                            </a>
                        </li>
                        <li>
                            <a href="{{ path('app_project_index') }}"
                               class="{{ app.request.get('_route') starts with 'app_project' ? 'bg-white/20 text-white' : 'text-white/80 hover:bg-white/10 hover:text-white' }} group flex gap-x-3 rounded-lg p-2.5 text-sm font-semibold leading-6 transition-all">
                                <svg class="h-6 w-6 shrink-0 {{ app.request.get('_route') starts with 'app_project' ? 'text-white' : 'text-white/70 group-hover:text-white' }}" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12.75V12A2.25 2.25 0 0 1 4.5 9.75h15A2.25 2.25 0 0 1 21.75 12v.75m-8.69-6.44-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z" />
                                </svg>
                                Projects
                            </a>
                        </li>
                        <li>
                            <a href="{{ path('app_task_my_tasks') }}"
                               class="{{ app.request.get('_route') == 'app_task_my_tasks' ? 'bg-white/20 text-white' : 'text-white/80 hover:bg-white/10 hover:text-white' }} group flex gap-x-3 rounded-lg p-2.5 text-sm font-semibold leading-6 transition-all">
                                <svg class="h-6 w-6 shrink-0 {{ app.request.get('_route') == 'app_task_my_tasks' ? 'text-white' : 'text-white/70 group-hover:text-white' }}" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                                </svg>
                                My Tasks
                            </a>
                        </li>
                        <li>
                            <a href="{{ path('app_task_all_tasks') }}"
                               class="{{ app.request.get('_route') == 'app_task_all_tasks' ? 'bg-white/20 text-white' : 'text-white/80 hover:bg-white/10 hover:text-white' }} group flex gap-x-3 rounded-lg p-2.5 text-sm font-semibold leading-6 transition-all">
                                <svg class="h-6 w-6 shrink-0 {{ app.request.get('_route') == 'app_task_all_tasks' ? 'text-white' : 'text-white/70 group-hover:text-white' }}" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 6.75h12M8.25 12h12m-12 5.25h12M3.75 6.75h.007v.008H3.75V6.75Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0ZM3.75 12h.007v.008H3.75V12Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm-.375 5.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z" />
                                </svg>
                                All Tasks
                            </a>
                        </li>
                    </ul>
                </li>

                <li id="favourite-projects-section" class="{{ favourite_projects is not defined or favourite_projects|length == 0 ? 'hidden' : '' }}">
                    <div class="text-xs font-semibold leading-6 text-white/50 uppercase tracking-wider flex items-center gap-1">
                        <svg class="h-3 w-3 text-yellow-400" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                        </svg>
                        Favourites
                    </div>
                    <ul role="list" class="-mx-2 mt-2 space-y-1" id="favourite-projects-list">
                        {% for project in favourite_projects|default([]) %}
                        <li class="favourite-project-item group/item overflow-hidden{{ loop.index > 3 ? ' fav-overflow hidden' : '' }}" data-project-id="{{ project.id }}" data-project-name="{{ project.name }}">
                            <div class="flex items-center gap-x-1 min-w-0">
                                <a href="{{ path('app_project_show', {id: project.id}) }}"
                                   class="text-white/80 hover:bg-white/10 hover:text-white flex-1 min-w-0 flex gap-x-3 rounded-lg p-2.5 text-sm font-semibold leading-6 transition-all">
                                    <span class="flex h-6 w-6 shrink-0 items-center justify-center rounded-lg bg-yellow-500/20 text-[0.625rem] font-medium text-yellow-300 group-hover/item:bg-yellow-500/30">
                                        {{ project.name|slice(0, 1)|upper }}
                                    </span>
                                    <span class="truncate">{{ project.name }}</span>
                                </a>
                                <button type="button"
                                        onclick="removeFavourite('{{ project.id }}', this)"
                                        class="opacity-0 group-hover/item:opacity-100 p-1.5 rounded-md text-white/50 hover:text-white hover:bg-white/10 transition-all"
                                        title="Remove from favourites">
                                    <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                                    </svg>
                                </button>
                            </div>
                        </li>
                        {% endfor %}
                    </ul>
                    {% if favourite_projects|default([])|length > 3 %}
                    <button type="button" onclick="toggleFavOverflow(this)" class="fav-show-more -mx-2 mt-1 w-full text-left px-2.5 py-1.5 text-xs font-medium text-white/50 hover:text-white/80 transition-colors" data-list-id="favourite-projects-list">
                        <span class="fav-more-text">{{ favourite_projects|length - 3 }} more</span>
                    </button>
                    {% endif %}
                </li>

                {% if recent_projects is defined and recent_projects|length > 0 %}
                <li>
                    <div class="text-xs font-semibold leading-6 text-white/50 uppercase tracking-wider">Recent Projects</div>
                    <ul role="list" class="-mx-2 mt-2 space-y-1" id="recent-projects-list">
                        {% for project in recent_projects %}
                        <li class="recent-project-item group/item overflow-hidden" data-project-id="{{ project.id }}">
                            <div class="flex items-center gap-x-1 min-w-0">
                                <a href="{{ path('app_project_show', {id: project.id}) }}"
                                   class="text-white/80 hover:bg-white/10 hover:text-white flex-1 min-w-0 flex gap-x-3 rounded-lg p-2.5 text-sm font-semibold leading-6 transition-all">
                                    <span class="flex h-6 w-6 shrink-0 items-center justify-center rounded-lg bg-white/20 text-[0.625rem] font-medium text-white group-hover/item:bg-white/30">
                                        {{ project.name|slice(0, 1)|upper }}
                                    </span>
                                    <span class="truncate">{{ project.name }}</span>
                                </a>
                                <button type="button"
                                        onclick="hideRecentProject('{{ project.id }}', this)"
                                        class="opacity-0 group-hover/item:opacity-100 p-1.5 rounded-md text-white/50 hover:text-white hover:bg-white/10 transition-all"
                                        title="Remove from recent">
                                    <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                                    </svg>
                                </button>
                            </div>
                        </li>
                        {% endfor %}
                    </ul>
                </li>
                {% endif %}

                {% if app.user.portalRole and app.user.isPortalAdmin %}
                <li>
                    <div class="text-xs font-semibold leading-6 text-white/50 uppercase tracking-wider">Administration</div>
                    <ul role="list" class="-mx-2 mt-2 space-y-1">
                        <li>
                            <a href="{{ path('app_admin_users') }}"
                               class="{{ app.request.get('_route') starts with 'app_admin_users' ? 'bg-white/20 text-white' : 'text-white/80 hover:bg-white/10 hover:text-white' }} group flex gap-x-3 rounded-lg p-2.5 text-sm font-semibold leading-6 transition-all">
                                <svg class="h-6 w-6 shrink-0 {{ app.request.get('_route') starts with 'app_admin_users' ? 'text-white' : 'text-white/70 group-hover:text-white' }}" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M15 19.128a9.38 9.38 0 0 0 2.625.372 9.337 9.337 0 0 0 4.121-.952 4.125 4.125 0 0 0-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 0 1 8.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0 1 11.964-3.07M12 6.375a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0Zm8.25 2.25a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z" />
                                </svg>
                                Users
                            </a>
                        </li>
                        <li>
                            <a href="{{ path('app_admin_roles') }}"
                               class="{{ app.request.get('_route') starts with 'app_admin_roles' ? 'bg-white/20 text-white' : 'text-white/80 hover:bg-white/10 hover:text-white' }} group flex gap-x-3 rounded-lg p-2.5 text-sm font-semibold leading-6 transition-all">
                                <svg class="h-6 w-6 shrink-0 {{ app.request.get('_route') starts with 'app_admin_roles' ? 'text-white' : 'text-white/70 group-hover:text-white' }}" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285Z" />
                                </svg>
                                Roles
                            </a>
                        </li>
                    </ul>
                </li>
                {% endif %}

                <li class="mt-auto">
                    <a href="{{ path('app_profile') }}"
                       class="{{ app.request.get('_route') starts with 'app_profile' ? 'bg-white/20 text-white' : 'text-white/80 hover:bg-white/10 hover:text-white' }} group -mx-2 flex gap-x-3 rounded-lg p-2.5 text-sm font-semibold leading-6 transition-all">
                        <svg class="h-6 w-6 shrink-0 {{ app.request.get('_route') starts with 'app_profile' ? 'text-white' : 'text-white/70 group-hover:text-white' }}" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z" />
                            <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
                        </svg>
                        Settings
                    </a>
                </li>
            </ul>
        </nav>
    </div>
    {% else %}
    {# Classic White Theme #}
    <div class="flex grow flex-col gap-y-5 overflow-y-auto sidebar-scroll border-r border-gray-200 bg-white px-6 pb-4">
        <div class="flex h-16 shrink-0 items-center">
            <span class="text-2xl">ðŸ“‹</span>
            <span class="ml-2 text-xl font-bold text-gray-900">WorkFlow</span>
        </div>
        <nav class="flex flex-1 flex-col">
            <ul role="list" class="flex flex-1 flex-col gap-y-7">
                <li>
                    <ul role="list" class="-mx-2 space-y-1">
                        <li>
                            <a href="{{ path('app_dashboard') }}"
                               class="{{ app.request.get('_route') == 'app_dashboard' ? 'bg-gray-50 text-primary-600' : 'text-gray-700 hover:bg-gray-50 hover:text-primary-600' }} group flex gap-x-3 rounded-md p-2 text-sm font-semibold leading-6">
                                <svg class="h-6 w-6 shrink-0 {{ app.request.get('_route') == 'app_dashboard' ? 'text-primary-600' : 'text-gray-400 group-hover:text-primary-600' }}" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25" />
                                </svg>
                                Dashboard
                            </a>
                        </li>
                        <li>
                            <a href="{{ path('app_project_index') }}"
                               class="{{ app.request.get('_route') starts with 'app_project' ? 'bg-gray-50 text-primary-600' : 'text-gray-700 hover:bg-gray-50 hover:text-primary-600' }} group flex gap-x-3 rounded-md p-2 text-sm font-semibold leading-6">
                                <svg class="h-6 w-6 shrink-0 {{ app.request.get('_route') starts with 'app_project' ? 'text-primary-600' : 'text-gray-400 group-hover:text-primary-600' }}" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12.75V12A2.25 2.25 0 0 1 4.5 9.75h15A2.25 2.25 0 0 1 21.75 12v.75m-8.69-6.44-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z" />
                                </svg>
                                Projects
                            </a>
                        </li>
                        <li>
                            <a href="{{ path('app_task_my_tasks') }}"
                               class="{{ app.request.get('_route') == 'app_task_my_tasks' ? 'bg-gray-50 text-primary-600' : 'text-gray-700 hover:bg-gray-50 hover:text-primary-600' }} group flex gap-x-3 rounded-md p-2 text-sm font-semibold leading-6">
                                <svg class="h-6 w-6 shrink-0 {{ app.request.get('_route') == 'app_task_my_tasks' ? 'text-primary-600' : 'text-gray-400 group-hover:text-primary-600' }}" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                                </svg>
                                My Tasks
                            </a>
                        </li>
                        <li>
                            <a href="{{ path('app_task_all_tasks') }}"
                               class="{{ app.request.get('_route') == 'app_task_all_tasks' ? 'bg-gray-50 text-primary-600' : 'text-gray-700 hover:bg-gray-50 hover:text-primary-600' }} group flex gap-x-3 rounded-md p-2 text-sm font-semibold leading-6">
                                <svg class="h-6 w-6 shrink-0 {{ app.request.get('_route') == 'app_task_all_tasks' ? 'text-primary-600' : 'text-gray-400 group-hover:text-primary-600' }}" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 6.75h12M8.25 12h12m-12 5.25h12M3.75 6.75h.007v.008H3.75V6.75Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0ZM3.75 12h.007v.008H3.75V12Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm-.375 5.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z" />
                                </svg>
                                All Tasks
                            </a>
                        </li>
                    </ul>
                </li>

                <li id="favourite-projects-section-classic" class="{{ favourite_projects is not defined or favourite_projects|length == 0 ? 'hidden' : '' }}">
                    <div class="text-xs font-semibold leading-6 text-gray-400 flex items-center gap-1">
                        <svg class="h-3 w-3 text-yellow-500" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                        </svg>
                        Favourites
                    </div>
                    <ul role="list" class="-mx-2 mt-2 space-y-1" id="favourite-projects-list-classic">
                        {% for project in favourite_projects|default([]) %}
                        <li class="favourite-project-item group/item overflow-hidden{{ loop.index > 3 ? ' fav-overflow hidden' : '' }}" data-project-id="{{ project.id }}" data-project-name="{{ project.name }}">
                            <div class="flex items-center gap-x-1 min-w-0">
                                <a href="{{ path('app_project_show', {id: project.id}) }}"
                                   class="text-gray-700 hover:bg-yellow-50 hover:text-yellow-700 flex-1 min-w-0 flex gap-x-3 rounded-md p-2 text-sm font-semibold leading-6">
                                    <span class="flex h-6 w-6 shrink-0 items-center justify-center rounded-lg border border-yellow-300 bg-yellow-50 text-[0.625rem] font-medium text-yellow-600 group-hover/item:border-yellow-400 group-hover/item:bg-yellow-100">
                                        {{ project.name|slice(0, 1)|upper }}
                                    </span>
                                    <span class="truncate">{{ project.name }}</span>
                                </a>
                                <button type="button"
                                        onclick="removeFavourite('{{ project.id }}', this)"
                                        class="opacity-0 group-hover/item:opacity-100 p-1.5 rounded-md text-gray-400 hover:text-gray-600 hover:bg-gray-100 transition-all"
                                        title="Remove from favourites">
                                    <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                                    </svg>
                                </button>
                            </div>
                        </li>
                        {% endfor %}
                    </ul>
                    {% if favourite_projects|default([])|length > 3 %}
                    <button type="button" onclick="toggleFavOverflow(this)" class="fav-show-more -mx-2 mt-1 w-full text-left px-2.5 py-1.5 text-xs font-medium text-gray-400 hover:text-gray-600 transition-colors" data-list-id="favourite-projects-list-classic">
                        <span class="fav-more-text">{{ favourite_projects|length - 3 }} more</span>
                    </button>
                    {% endif %}
                </li>

                {% if recent_projects is defined and recent_projects|length > 0 %}
                <li>
                    <div class="text-xs font-semibold leading-6 text-gray-400">Recent Projects</div>
                    <ul role="list" class="-mx-2 mt-2 space-y-1" id="recent-projects-list-classic">
                        {% for project in recent_projects %}
                        <li class="recent-project-item group/item overflow-hidden" data-project-id="{{ project.id }}">
                            <div class="flex items-center gap-x-1 min-w-0">
                                <a href="{{ path('app_project_show', {id: project.id}) }}"
                                   class="text-gray-700 hover:bg-gray-50 hover:text-primary-600 flex-1 min-w-0 flex gap-x-3 rounded-md p-2 text-sm font-semibold leading-6">
                                    <span class="flex h-6 w-6 shrink-0 items-center justify-center rounded-lg border border-gray-200 bg-white text-[0.625rem] font-medium text-gray-400 group-hover/item:border-primary-600 group-hover/item:text-primary-600">
                                        {{ project.name|slice(0, 1)|upper }}
                                    </span>
                                    <span class="truncate">{{ project.name }}</span>
                                </a>
                                <button type="button"
                                        onclick="hideRecentProject('{{ project.id }}', this)"
                                        class="opacity-0 group-hover/item:opacity-100 p-1.5 rounded-md text-gray-400 hover:text-gray-600 hover:bg-gray-100 transition-all"
                                        title="Remove from recent">
                                    <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                                    </svg>
                                </button>
                            </div>
                        </li>
                        {% endfor %}
                    </ul>
                </li>
                {% endif %}

                {% if app.user.portalRole and app.user.isPortalAdmin %}
                <li>
                    <div class="text-xs font-semibold leading-6 text-gray-400">Administration</div>
                    <ul role="list" class="-mx-2 mt-2 space-y-1">
                        <li>
                            <a href="{{ path('app_admin_users') }}"
                               class="{{ app.request.get('_route') starts with 'app_admin_users' ? 'bg-gray-50 text-primary-600' : 'text-gray-700 hover:bg-gray-50 hover:text-primary-600' }} group flex gap-x-3 rounded-md p-2 text-sm font-semibold leading-6">
                                <svg class="h-6 w-6 shrink-0 {{ app.request.get('_route') starts with 'app_admin_users' ? 'text-primary-600' : 'text-gray-400 group-hover:text-primary-600' }}" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M15 19.128a9.38 9.38 0 0 0 2.625.372 9.337 9.337 0 0 0 4.121-.952 4.125 4.125 0 0 0-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 0 1 8.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0 1 11.964-3.07M12 6.375a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0Zm8.25 2.25a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z" />
                                </svg>
                                Users
                            </a>
                        </li>
                        <li>
                            <a href="{{ path('app_admin_roles') }}"
                               class="{{ app.request.get('_route') starts with 'app_admin_roles' ? 'bg-gray-50 text-primary-600' : 'text-gray-700 hover:bg-gray-50 hover:text-primary-600' }} group flex gap-x-3 rounded-md p-2 text-sm font-semibold leading-6">
                                <svg class="h-6 w-6 shrink-0 {{ app.request.get('_route') starts with 'app_admin_roles' ? 'text-primary-600' : 'text-gray-400 group-hover:text-primary-600' }}" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285Z" />
                                </svg>
                                Roles
                            </a>
                        </li>
                    </ul>
                </li>
                {% endif %}

                <li class="mt-auto">
                    <a href="{{ path('app_profile') }}"
                       class="{{ app.request.get('_route') starts with 'app_profile' ? 'bg-gray-50 text-primary-600' : 'text-gray-700 hover:bg-gray-50 hover:text-primary-600' }} group -mx-2 flex gap-x-3 rounded-md p-2 text-sm font-semibold leading-6">
                        <svg class="h-6 w-6 shrink-0 {{ app.request.get('_route') starts with 'app_profile' ? 'text-primary-600' : 'text-gray-400 group-hover:text-primary-600' }}" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z" />
                            <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
                        </svg>
                        Settings
                    </a>
                </li>
            </ul>
        </nav>
    </div>
    {% endif %}
</div>

<style>
.sidebar-scroll {
    scrollbar-width: thin;
    scrollbar-color: rgba(255,255,255,0.3) transparent;
}
.sidebar-scroll::-webkit-scrollbar { width: 6px; }
.sidebar-scroll::-webkit-scrollbar-track { background: transparent; }
.sidebar-scroll::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.3); border-radius: 3px; }
.sidebar-scroll::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.5); }

/* Classic white theme override */
.bg-white.sidebar-scroll {
    scrollbar-color: #d1d5db transparent;
}
.bg-white.sidebar-scroll::-webkit-scrollbar-thumb { background: #d1d5db; }
.bg-white.sidebar-scroll::-webkit-scrollbar-thumb:hover { background: #9ca3af; }
</style>
