{# Task Card Component - Vue Version #}
{# Required variables: task #}
{# Optional: draggable (default: false) #}
{#
   This uses Vue for reactivity. The card will update when task properties change.
   The Vue component will auto-mount on elements with data-vue-component="TaskCard"
#}
<div
    data-vue-component="TaskCard"
    data-vue-task='{{ {
        id: task.id|default(task.id.toString()),
        title: task.title,
        priority: { value: task.priority.value, label: task.priority.label },
        status: { value: task.status.value, label: task.status.label },
        projectName: task.project.name,
        dueDate: task.dueDate ? task.dueDate|date('Y-m-d') : null,
        commentCount: task.commentCount|default(0),
        checklistCount: task.checklistCount|default(0),
        completedChecklistCount: task.completedChecklistCount|default(0),
        assignees: task.assignees|map(a => {
            id: a.id|default(a.id.toString()),
            user: {
                id: a.user.id|default(a.user.id.toString()),
                firstName: a.user.firstName,
                lastName: a.user.lastName,
                fullName: a.user.fullName
            }
        }),
        tags: task.tags|map(t => {
            id: t.id|default(t.id.toString()),
            name: t.name,
            color: t.color
        })
    }|json_encode|e('html_attr') }}'
    data-vue-draggable="{{ draggable|default(false) ? 'true' : 'false' }}"
    data-vue-base-path="{{ app.request.basePath }}"
>
    {# Fallback content shown before Vue mounts #}
    <noscript>
        <div data-task-id="{{ task.id }}"
             class="task-card bg-white rounded-lg shadow-sm border border-gray-200 p-4 hover:shadow-md transition-all duration-200">
            <div class="flex items-start justify-between">
                <h4 class="text-sm font-medium text-gray-900 flex-1">
                    <a href="{{ path('app_task_show', {id: task.id}) }}" class="hover:text-primary-600">
                        {{ task.title }}
                    </a>
                </h4>
                <span class="ml-2 flex-shrink-0 inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium
                    {% if task.priority.value == 'high' %}bg-red-100 text-red-700
                    {% elseif task.priority.value == 'medium' %}bg-yellow-100 text-yellow-700
                    {% elseif task.priority.value == 'low' %}bg-blue-100 text-blue-700
                    {% else %}bg-gray-100 text-gray-700{% endif %}">
                    {{ task.priority.label }}
                </span>
            </div>
            <p class="mt-1 text-xs text-gray-500">{{ task.project.name }}</p>
        </div>
    </noscript>
</div>
