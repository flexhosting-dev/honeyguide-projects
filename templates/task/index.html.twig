{% extends 'layout.html.twig' %}

{% block title %}My Tasks - WorkFlow{% endblock %}

{% block content %}
{# Determine filtered project ID: only if exactly one project is filtered #}
{% set filteredProjectId = filter.projectIds|length == 1 ? filter.projectIds|first : '' %}

{% include 'task/_task_page.html.twig' with {
    pageTitle: 'My Tasks',
    pageDescription: 'All tasks assigned to you across all projects.',
    formAction: 'app_task_my_tasks',
    tasks: tasks,
    tasksByStatus: tasksByStatus,
    tasksByPriority: tasksByPriority,
    tasksByMilestone: tasksByMilestone,
    milestones: milestones,
    kanbanModeKey: 'my_tasks_kanban_mode',
    filter: filter,
    userProjects: userProjects,
    projectMembers: projectMembers,
    showProjectFilter: true,
    storageKey: 'my_tasks_view',
    showHeader: true,
    showAddButton: true,
    canCreateTask: personalProject is defined and personalProject and personalProject.milestones|length > 0,
    project: personalProject,
    availableProjects: editableProjects,
    filteredProjectId: filteredProjectId,
    canEdit: true
} %}
{% endblock %}
